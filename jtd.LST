C51 COMPILER V9.57.0.0   JTD                                                               03/09/2019 16:45:41 PAGE 1   


C51 COMPILER V9.57.0.0, COMPILATION OF MODULE JTD
OBJECT MODULE PLACED IN jtd.OBJ
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE jtd.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          #include <reg51.h>        //Í·ÎÄ¼ş
   2          #define uchar unsigned char
   3          #define uint  unsigned int    //ºê¶¨Òå
   4          
   5          uchar data buf[4];          //ÃëÏÔÊ¾µÄ±äÁ¿
   6          uchar data sec_dx=20;       //¶«Î÷ÊıÄ¬ÈÏ
   7          uchar data sec_nb=30;     //ÄÏ±±Ä¬ÈÏÖµ
   8          uchar data set_timedx=20;   //ÉèÖÃ¶«Î÷·½ÏòµÄÊ±¼ä
   9          uchar data set_timenb=30;   //ÉèÖÃÄÏ±±·½ÏòµÄÊ±¼ä
  10          
  11          
  12          
  13          uchar data num_che_dx=0;    //ÉèÖÃ±äÁ¿ÓÃÓÚ¼ÇÂ¼¶«Î÷Í¨ĞĞ³µÁ¿µÄ¸öÊı
  14          uchar data num_che_nb=0;    //ÉèÖÃ±äÁ¿ÓÃÓÚ¼ÇÂ¼ÄÏ±±Í¨ĞĞ³µÁ¾µÄ¸öÊı
  15          
  16          
  17          uchar data xianshi_fx=0;        //ÏÔÊ¾·½Ê½
  18          int n;
  19          uchar data countt0,countt1;//¶¨Ê±Æ÷0ÖĞ¶Ï´ÎÊı
  20          //¶¨Òå6×é¿ª¹Ø
  21          sbit  k1=P1^5;    //Ò¹¼äÄ£Ê½
  22          sbit  k2=P1^4;    //½ûÖ¹
  23          sbit  k3=P3^4;    //È·ÈÏ
  24          sbit  k4=P1^6;    //¶«Î÷Í¨ĞĞ
  25          sbit  k5=P1^7;    //ÄÏ±±Í¨ĞĞ
  26          sbit  hw_dx=P3^5;   //Ê¹ÓÃ´ËÒı½Å½ÓºìÍâÌ½Í·¼ì²â"¶«Î÷"·½ÏòÍ¨¹ıµÄ³µÁ¾µ±¼ì²âµ½ÄÏ±±ÓĞ³µÁ¾Í¨ĞĞÊ±£¬¸ÃÒı½Å»á³ÊÏÖµÍµ
             -çÆ½
  27          sbit  hw_nb=P3^6;   //Ê¹ÓÃ´ËÒı½Å½ÓºìÍâÌ½Í·¼ì²â"ÄÏ±±"·½ÏòÍ¨¹ıµÄ³µÁ¾µ±¼ì²âµ½ÄÏ±±ÓĞ³µÁ¾Í¨ĞĞÊ±£¬¸ÃÒı½Å»á³ÊÏÖµÍµ
             -çÆ½
  28          sbit  k6=P3^7;      //ÇĞ»»·½Ïò
  29          
  30          sbit Red_nb=P2^6;   //ÄÏ±±ºìµÆ±êÖ¾
  31          sbit Yellow_nb=P2^5;  //ÄÏ±±»ÆµÆ±êÖ¾
  32          sbit Green_nb=P2^4;     //ÄÏ±±ÂÌµÆ±êÖ¾
  33          
  34          sbit Red_dx=P2^3;   //¶«Î÷ºìµÆ±êÖ¾
  35          sbit Yellow_dx=P2^2;  //¶«Î÷»ÆµÆ±êÖ¾
  36          sbit Green_dx=P2^1;   //¶«Î÷ÂÌµÆ±êÖ¾
  37            
  38          sbit Buzz=P3^3;   
  39          bit set=0;        //µ÷Ê±·½ÏòÇĞ»»¼ü±êÖ¾ =1Ê±£¬ÄÏ±±£¬=0Ê±£¬¶«Î÷
  40          bit dx_nb=0;      //¶«Î÷ÄÏ±±¿ØÖÆÎ»
  41          bit shanruo=0;      //ÉÁË¸±êÖ¾Î»
  42          bit yejian=0;     //Ò¹¼ä»ÆµÆÉÁË¸±êÖ¾Î»
  43          
  44          uchar code table[11]={  //¹²Òõ¼«×ÖĞÍÂë
  45            0x3f,  //--0
  46            0x06,  //--1
  47            0x5b,  //--2
  48            0x4f,  //--3
  49            0x66,  //--4
  50            0x6d,  //--5
  51            0x7d,  //--6
  52            0x07,  //--7
  53            0x7f,  //--8
C51 COMPILER V9.57.0.0   JTD                                                               03/09/2019 16:45:41 PAGE 2   

  54            0x6f,  //--9
  55            0x00   //--NULL
  56          };
  57          
  58          //º¯ÊıµÄÉùÃ÷²¿·Ö
  59          void delay(int ms);     //ÑÓÊ±×Ó³ÌĞò
  60          void key();         //°´¼üÉ¨Ãè×Ó³ÌĞò
  61          void key_to1();       //¼ü´¦Àí×Ó³ÌĞò
  62          void key_to2();
  63          void key_to3();
  64          void key_to4();
  65          void key_to5();
  66          void display();       //ÏÔÊ¾×Ó³ÌĞò
  67          void logo();          //¿ª»úLOGO
  68          void Buzzer();
  69          //Ö÷³ÌĞò
  70          void main()
  71          {
  72   1        TMOD=0X11;            //¶¨Ê±Æ÷ÉèÖÃ
  73   1        TH1=0X3C;   
  74   1        TL1=0XB0;
  75   1        TH0=0X3C;         //¶¨Ê±Æ÷0ÖÃ³õÖµ 0.05S
  76   1        TL0=0XB0;
  77   1        SCON=0X50;          //ÉèÖÃÎª¹¤×÷·½Ê½1,8Î»Êı¾İ£¬¿É±ä²¨ÌØÂÊ
  78   1        PCON=0X00;          //²¨ÌØÂÊ²»¼Ó±¶
  79   1        ES = 1;               //¿ª´®¿ÚÖĞ¶Ï
  80   1        EA=1;           //¿ª×ÜÖĞ¶Ï
  81   1        ET0=1;            //¶¨Ê±Æ÷0ÖĞ¶Ï¿ªÆô
  82   1        ET1=1;             //¶¨Ê±Æ÷1ÖĞ¶Ï¿ªÆô
  83   1        TR0=1;            //Æô¶¯¶¨Ê±0
  84   1        TR1=0;            //¹Ø±Õ¶¨Ê±1
  85   1        EX0=1;            //¿ªÍâ²¿ÖĞ¶Ï0
  86   1        EX1=1;            //¿ªÍâ²¿ÖĞ¶Ï1
  87   1          logo();           //¿ª»ú³õÊ¼»¯
  88   1        P2=0Xc3;          // ¿ªÊ¼Ä¬ÈÏ×´Ì¬£¬¶«Î÷ÂÌµÆ£¬ÄÏ±±»ÆµÆ   
  89   1          sec_nb=sec_dx+5;      //Ä¬ÈÏÄÏ±±Í¨ĞĞÊ±¼ä±È¶«Î÷¶à5Ãë
  90   1        while(1)            //Ö÷Ñ­»·
  91   1        {  
  92   2          key();          //µ÷ÓÃ°´¼üÉ¨Ãè³ÌĞò
  93   2          display();        //µ÷ÓÃÏÔÊ¾³ÌĞò
  94   2        } 
  95   1      }
  96          
  97          void key_to1()        //Ò¹¼äÄ£Ê½ÉèÖÃº¯Êı
  98          {
  99   1        TR0=0;            //¹Ø¶¨Ê±Æ÷
 100   1        P2=0x00;
 101   1        TR1=1;
 102   1        sec_dx=00;          //ËÄ¸ö·½ÏòµÄÊ±¼ä¶¼Îª00
 103   1        sec_nb=00;
 104   1      }
 105          
 106          
 107          void key_to2()        //½ûÖ¹Í¨ĞĞÄ£Ê½ÉèÖÃº¯Êı
 108          {
 109   1        TR0=0;            //¹Ø¶¨Ê±Æ÷
 110   1        P2=0x00;          //ÃğÏÔÊ¾
 111   1        Red_dx=1;
 112   1        Red_nb=1;         //È«²¿ÖÃºìµÆ
 113   1        TR1=0;
 114   1        sec_dx=00;          //ËÄ¸ö·½ÏòµÄÊ±¼ä¶¼Îª00
 115   1        sec_nb=00;
C51 COMPILER V9.57.0.0   JTD                                                               03/09/2019 16:45:41 PAGE 3   

 116   1      }
 117          
 118          
 119          void key_to3()        //È·ÈÏÉèÖÃº¯Êı
 120          {
 121   1        TR0=1;              //Æô¶¯¶¨Ê±Æ÷0
 122   1        xianshi_fx=0;         //ÉèÖÃÖØĞÂÏÔÊ¾
 123   1        sec_nb=set_timenb;        //´ÓÖĞ¶Ï»Ø¸´£¬ÈÔÏÔÊ¾ÉèÖÃ¹ıµÄÊıÖµ
 124   1        sec_dx=set_timedx;        //ÏÔÊ¾ÉèÖÃ¹ıµÄÊ±¼ä
 125   1        TR1=0;              //¹Ø¶¨Ê±Æ÷1 
 126   1        if(set==0)            //Ê±¼äµ¹Ê±µ½0Ê±
 127   1        { 
 128   2          P2=0X00;           //ÃğÏÔÊ¾
 129   2          Green_dx=1;           //¶«Î÷ÂÌµÆÁÁ
 130   2          Red_nb=1;         //ÄÏ±±ºìµÆÁÁ
 131   2          sec_nb=sec_dx+5;      //»Øµ½³õÖµ
 132   2        }
 133   1        else 
 134   1        { 
 135   2          P2=0x00;          //ÄÏ±±ÂÌµÆ£¬¶«Î÷ºìµÆ
 136   2          Green_nb=1;
 137   2          Red_dx=1;
 138   2          sec_dx=sec_nb+5; 
 139   2        }
 140   1      }
 141          
 142          void key_to4()        //¶«Î÷Í¨ĞĞÉèÖÃº¯Êı
 143          {
 144   1        TR0=0;                //¹Ø¶¨Ê±Æ÷0
 145   1        TR1=0;                //¹Ø¶¨Ê±Æ÷1
 146   1        P2=0x00;              //ÃğÏÔÊ¾
 147   1        Green_dx=1;             //¶«Î÷·½ÏòÖÃÂÌµÆ
 148   1        Red_nb=1;             //ÄÏ±±·½ÏòÎªºìµÆ
 149   1        sec_dx=00;              //ËÄ¸ö·½ÏòµÄÊ±¼ä¶¼Îª00
 150   1        sec_nb=00;  
 151   1      }
 152          
 153          void key_to5()        //ÄÏ±±Í¨ĞĞÉèÖÃº¯Êı
 154          {
 155   1        TR0=0;                //¹Ø¶¨Ê±Æ÷0
 156   1        TR1=0;                 //¹Ø¶¨Ê±Æ÷1
 157   1        P2=0x00;              //ÃğÏÔÊ¾
 158   1        Green_nb=1;             //ÖÃÄÏ±±·½ÏòÎªÂÌµÆ
 159   1        Red_dx=1;             //¶«Î÷·½ÏòÎªºìµÆ
 160   1        sec_nb=00;              //ËÄ¸ö·½ÏòµÄÊ±¼ä¶¼Îª00
 161   1        sec_dx=00;
 162   1      }
 163          
 164          //º¯ÊıµÄ¶¨Òå²¿·Ö
 165          void key(void)  //°´¼üÉ¨Ãè×Ó³ÌĞò
 166          { 
 167   1        if(k1!=1)             //µ±K1£¨Ò¹¼äÄ£Ê½£©°´ÏÂ 
 168   1        {
 169   2            display();              //µ÷ÓÃÏÔÊ¾£¬ÓÃÓÚÑÓÊ±Ïû¶¶ 
 170   2            if(k1!=1)           //Èç¹ûÈ·¶¨°´ÏÂ
 171   2            {   
 172   3              key_to1();          //Ò¹¼äÄ£Ê½ÉèÖÃº¯Êı
 173   3            do
 174   3            {
 175   4              display();        //µ÷ÓÃÏÔÊ¾£¬ÓÃÓÚÑÓÊ±
 176   4            } 
 177   3            while(k1!=1);     //µÈ´ı°´¼üÊÍ·Å  
C51 COMPILER V9.57.0.0   JTD                                                               03/09/2019 16:45:41 PAGE 4   

 178   3            }
 179   2        } 
 180   1          if(k2!=1)             //µ±K2£¨½ûÖ¹£©¼ü°´ÏÂÊ±
 181   1        {
 182   2            display();              //µ÷ÓÃÏÔÊ¾£¬ÓÃÓÚÑÓÊ±Ïû¶¶
 183   2            if(k2!=1)           //Èç¹ûÈ·¶¨°´ÏÂ
 184   2            {   
 185   3              key_to2();          //Í£Ö¹Í¨ĞĞÉèÖÃº¯Êı
 186   3            do
 187   3            {
 188   4              display();        //µ÷ÓÃÏÔÊ¾£¬ÓÃÓÚÑÓÊ±
 189   4            } 
 190   3            while(k2!=1);     //µÈ´ı°´¼üÊÍ·Å  
 191   3            }
 192   2        }
 193   1          if(k3!=1)             //µ±K3£¨È·ÈÏ£©¼ü°´ÏÂÊ±
 194   1        { 
 195   2          display();              //µ÷ÓÃÏÔÊ¾£¬ÓÃÓÚÑÓÊ±Ïû¶¶
 196   2          if(k3!=1)           //Èç¹ûÈ·¶¨°´ÏÂ
 197   2          {
 198   3            key_to3();
 199   3            do
 200   3            {
 201   4              display();        //µ÷ÓÃÏÔÊ¾£¬ÓÃÓÚÑÓÊ±
 202   4            } 
 203   3            while(k3!=1);     //µÈ´ı°´¼üÊÍ·Å  
 204   3          }
 205   2        }
 206   1          
 207   1        if(k4!=1)             //µ±K4£¨¶«Î÷Í¨ĞĞ£©¼ü°´ÏÂÊ±
 208   1        { 
 209   2          display();              //µ÷ÓÃÏÔÊ¾£¬ÓÃÓÚÑÓÊ±Ïû¶¶
 210   2            if(k4!=1)           //Èç¹ûÈ·¶¨°´ÏÂ
 211   2            {   
 212   3            key_to4();          //¶«Î÷Í¨ĞĞº¯Êı
 213   3            do
 214   3            {
 215   4              display();        //µ÷ÓÃÏÔÊ¾£¬ÓÃÓÚÑÓÊ±
 216   4            } 
 217   3            while(k4!=1);     //µÈ´ı°´¼üÊÍ·Å  
 218   3            }
 219   2        }
 220   1      
 221   1        if(k5!=1)             //µ±K5£¨ÄÏ±±Í¨ĞĞ£©¼ü°´ÏÂÊ±
 222   1        { 
 223   2          display();              //µ÷ÓÃÏÔÊ¾£¬ÓÃÓÚÑÓÊ±Ïû¶¶
 224   2            if(k5!=1)           //Èç¹ûÈ·¶¨°´ÏÂ
 225   2            {   
 226   3            key_to4();          //ÄÏ±±Í¨ĞĞº¯Êı
 227   3            do
 228   3            {
 229   4              display();        //µ÷ÓÃÏÔÊ¾£¬ÓÃÓÚÑÓÊ±
 230   4            } 
 231   3            while(k5!=1);     //µÈ´ı°´¼üÊÍ·Å  
 232   3            }
 233   2        }
 234   1        
 235   1        if(hw_dx!=1)            //¶«Î÷ºìÍâÌ½Í·
 236   1        {
 237   2          display();              //µ÷ÓÃÏÔÊ¾£¬ÓÃÓÚÑÓÊ±Ïû¶¶ºÍ°´¼ü¼ì²â·½·¨»ù±¾ÏàÍ¬
 238   2          if(hw_dx!=1)          //Èç¹ûÈ·¶¨ÓĞ³µÁ¾¾­¹ı
 239   2          {
C51 COMPILER V9.57.0.0   JTD                                                               03/09/2019 16:45:41 PAGE 5   

 240   3            if(dx_nb==0)//¶«Î÷Í¨ĞĞµÄÊ±¼ä
 241   3            {
 242   4                
 243   4              num_che_dx++;//ÓÃÓÚ¼ÇÂ¼¶«Î÷ÂÌµÆÊ±¾­¹ıµÄ³µÁ¾Êı
 244   4            }
 245   3            else
 246   3            {
 247   4              Buzz=0;            //·äÃùÆ÷¿ª
 248   4            }
 249   3            while(hw_dx!=1);       //µÈ´ıÊÍ·Å
 250   3            { 
 251   4              display();         //µ÷ÓÃÏÔÊ¾£¬ÓÃÓÚÑÓÊ±
 252   4            }
 253   3            Buzz=1;            //·äÃùÆ÷¹Ø
 254   3          }
 255   2        }
 256   1      
 257   1        if(hw_nb!=1)              //ÄÏ±±ºìÍâÌ½Í·
 258   1        {   
 259   2          display();              //µ÷ÓÃÏÔÊ¾£¬ÓÃÓÚÑÓÊ±Ïû¶¶ºÍ°´¼ü¼ì²â·½·¨»ù±¾ÏàÍ¬ 
 260   2          if(hw_nb!=1)              //Èç¹ûÈ·¶¨ÓĞ³µÁ¾¾­¹ı
 261   2          {
 262   3            if(dx_nb==1)//¶«Î÷Í¨ĞĞµÄÊ±¼ä
 263   3            {
 264   4              num_che_nb++;//ÓÃÓÚ¼ÇÂ¼ÄÏ±±ÂÌµÆÊ±¾­¹ıµÄ³µÁ¾Êı
 265   4            }
 266   3            else
 267   3            {
 268   4              Buzz=0;            //·äÃùÆ÷¿ª
 269   4            }
 270   3            while(hw_nb!=1);       //µÈ´ıÊÍ·Å
 271   3            { 
 272   4              display();         //µ÷ÓÃÏÔÊ¾£¬ÓÃÓÚÑÓÊ±
 273   4            }
 274   3            Buzz=1;            //·äÃùÆ÷¹Ø
 275   3          }
 276   2        }
 277   1        if(k6!=1)             //£¨²é¿´£©¼ü°´ÏÂ
 278   1          {
 279   2          display();              //µ÷ÓÃÏÔÊ¾£¬ÓÃÓÚÑÓÊ±Ïû¶¶
 280   2          if(k6!=1)           //Èç¹ûÈ·¶¨°´ÏÂ
 281   2          {  
 282   3            xianshi_fx++;
 283   3                if(xianshi_fx>=3)
 284   3                  xianshi_fx=2;
 285   3            while(k6!=1);       //µÈ´ı°´¼üÊÍ·Å
 286   3              {
 287   4              display();         //µ÷ÓÃÏÔÊ¾£¬ÓÃÓÚÑÓÊ±
 288   4              } 
 289   3          }
 290   2        } 
 291   1      
 292   1      
 293   1      
 294   1      }
 295          void display(void) //ÏÔÊ¾×Ó³ÌĞò
 296          { 
 297   1      
 298   1        if(xianshi_fx==0)//Õı³£ÏÔÊ¾
 299   1        {
 300   2        buf[1]=sec_nb/10;     //µÚ1Î» ¶«Î÷ÏÔÊ¾ÃëÊ®Î»
 301   2        buf[2]=sec_nb%10;     //µÚ2Î» ¶«Î÷ÏÔÊ¾Ãë¸öÎ»
C51 COMPILER V9.57.0.0   JTD                                                               03/09/2019 16:45:41 PAGE 6   

 302   2        buf[3]=sec_dx/10;     //µÚ3Î» ÄÏ±±ÏÔÊ¾ÃëÊ®Î»
 303   2        buf[0]=sec_dx%10;     //µÚ4Î» ÄÏ±±ÏÔÊ¾Ãë¸öÎ»  
 304   2        }
 305   1        if(xianshi_fx==1)//²é¿´Í¨ĞĞÊ±¼ä
 306   1        {
 307   2        buf[1]=set_timenb/10;     //µÚ1Î» ¶«Î÷Í¨ĞĞÃëÊ®Î»
 308   2        buf[2]=set_timenb%10;     //µÚ2Î» ¶«Î÷Í¨ĞĞÃë¸öÎ»
 309   2        buf[3]=set_timedx/10;     //µÚ3Î» ÄÏ±±Í¨ĞĞÃëÊ®Î»
 310   2        buf[0]=set_timedx%10;     //µÚ4Î» ÄÏ±±Í¨ĞĞÃë¸öÎ»  
 311   2        }
 312   1      
 313   1        if(xianshi_fx==2)//²é¿´ºìÍâ¼ÆÊıÖµ
 314   1        {
 315   2        buf[1]=num_che_nb/10;     //µÚ1Î» ¶«Î÷ºìÍâ¼ÆÊıÖµÊ®Î»
 316   2        buf[2]=num_che_nb%10;     //µÚ2Î» ¶«Î÷ºìÍâ¼ÆÊıÖµ¸öÎ»
 317   2        buf[3]=num_che_dx/10;     //µÚ3Î» ÄÏ±±ºìÍâ¼ÆÊıÖµÊ®Î»
 318   2        buf[0]=num_che_dx%10;     //µÚ4Î» ÄÏ±±ºìÍâ¼ÆÊıÖµ¸öÎ»  
 319   2        }
 320   1      
 321   1      
 322   1      
 323   1      
 324   1        
 325   1        P1=0xff;              // ³õÊ¼µÆÎªÃğµÄ
 326   1        P0=0x00;         ////ÃğÏÔÊ¾
 327   1        P1=0xfe;              //Æ¬Ñ¡LED1
 328   1        P0=table[buf[1]];   //ËÍ¶«Î÷Ê±¼äÊ®Î»µÄÊıÂë¹Ü±àÂë      
 329   1        delay(1);       //ÑÓÊ±
 330   1        P1=0xff;        //¹ØÏÔÊ¾
 331   1        P0=0x00;        //ÃğÏÔÊ¾
 332   1                     
 333   1        P1=0xfd;              //Æ¬Ñ¡LED2
 334   1        P0=table[buf[2]];    //ËÍ¶«Î÷Ê±¼ä¸öÎ»µÄÊıÂë¹Ü±àÂë
 335   1        delay(1);        //ÑÓÊ±
 336   1        P1=0xff;        //¹ØÏÔÊ¾
 337   1        P0=0x00;        //¹ØÏÔÊ¾
 338   1        P1=0Xfb;          //Æ¬Ñ¡LED3
 339   1        
 340   1        P0=table[buf[3]];   //ËÍÄÏ±±Ê±¼äÊ®Î»µÄÊıÂë¹Ü±àÂë
 341   1        delay(1);       //ÑÓÊ±
 342   1        P1=0xff;         //¹ØÏÔÊ¾
 343   1        P0=0x00;         //¹ØÏÔÊ¾
 344   1        P1=0Xf7;         //Æ¬Ñ¡LED4 
 345   1        P0=table[buf[0]];   //ËÍÄÏ±±Ê±¼ä¸öÎ»µÄÊıÂë¹Ü±àÂë
 346   1        delay(1);       //ÑÓÊ±
 347   1      }
 348          
 349          void time0(void) interrupt 1 using 1    //¶¨Ê±ÖĞ¶Ï×Ó³ÌĞò
 350          {
 351   1        TH0=0X3C;             //ÖØ¸³³õÖµ
 352   1        TL0=0XB0;             //12m¾§Õñ50ms//ÖØ¸³³õÖµ
 353   1        TR0=1;                //ÖØĞÂÆô¶¯¶¨Ê±Æ÷
 354   1        countt0++;              //Èí¼ş¼ÆÊı¼Ó1
 355   1        if(countt0==10)           //¼Óµ½10Ò²¾ÍÊÇ°ëÃë
 356   1        {
 357   2          if((sec_nb<=5)&&(dx_nb==0)&&(shanruo==1))     //¶«Î÷»ÆµÆÉÁ    
 358   2              {
 359   3            Green_dx=0;
 360   3            Yellow_dx=0;
 361   3            Buzz=0;           //·äÃùÆ÷¹Ø
 362   3          }             
 363   2            if((sec_dx<=5)&&(dx_nb==1)&&(shanruo==1))     //ÄÏ±±»ÆµÆÉÁ    
C51 COMPILER V9.57.0.0   JTD                                                               03/09/2019 16:45:41 PAGE 7   

 364   2              {  
 365   3            Green_nb=0;
 366   3            Yellow_nb=0;
 367   3            Buzz=0;            //·äÃùÆ÷¹Ø
 368   3          } 
 369   2        }
 370   1          
 371   1        if(countt0==20)                     // ¶¨Ê±Æ÷ÖĞ¶Ï´ÎÊı=20Ê±£¨¼´1ÃëÊ±£©
 372   1        { countt0=0;            //ÇåÁã¼ÆÊıÆ÷
 373   2          sec_dx--;           //¶«Î÷Ê±¼ä¼õ1
 374   2          sec_nb--;           //ÄÏ±±Ê±¼ä¼õ1
 375   2      
 376   2          if((sec_nb<=5)&&(dx_nb==0)&&(shanruo==1))     //¶«Î÷»ÆµÆÉÁ    
 377   2              {
 378   3            Green_dx=0;
 379   3            Yellow_dx=1;
 380   3            Buzz=1;            //·äÃùÆ÷¹Ø
 381   3          }             
 382   2            if((sec_dx<=5)&&(dx_nb==1)&&(shanruo==1))     //ÄÏ±±»ÆµÆÉÁ    
 383   2              {  
 384   3            Green_nb=0;
 385   3            Yellow_nb=1;
 386   3            Buzz=1;            //·äÃùÆ÷¹Ø
 387   3          }               
 388   2          if(sec_dx==0&&sec_nb==5)    //µ±¶«Î÷µ¹¼ÆÊ±µ½0Ê±£¬ÖØÖÃ5Ãë£¬ÓÃÓÚ»ÆµÆÉÁË¸Ê±¼ä   
 389   2          {
 390   3            sec_dx=5;
 391   3            shanruo=1;
 392   3          }
 393   2          if(sec_nb==0&&sec_dx==5)    //µ±ÄÏ±±µ¹¼ÆÊ±µ½0Ê±£¬ÖØÖÃ5Ãë£¬ÓÃÓÚ»ÆµÆÉÁË¸Ê±¼ä   
 394   2          {
 395   3            sec_nb=5;
 396   3            shanruo=1;
 397   3          }
 398   2          if(dx_nb==0&&sec_nb==0)     //µ±»ÆµÆÉÁË¸Ê±¼äµ¹¼ÆÊ±µ½0Ê±£¬
 399   2          {
 400   3              Buzz=1;           //·äÃùÆ÷¿ª
 401   3            P2=0x00;          //ÖØÖÃ¶«Î÷ÄÏ±³·½ÏòµÄºìÂÌµÆ
 402   3            Green_nb=1;
 403   3            Red_dx=1;
 404   3            dx_nb=!dx_nb;
 405   3            shanruo=0;
 406   3            if(num_che_nb>set_timenb/2)//Èç¹û´ËÊ±ÄÏ±±Í¨ĞĞµÄ³µÁ¾Êı´óÓÚÔ¤ÉèÍ¨ĞĞÁ¿
 407   3                    set_timenb=set_timenb+5;  
 408   3            if(num_che_nb==0)//Èç¹ûÄÏ±±·½ÏòÎŞ³µÁ¾Í¨ĞĞ,Ã¿´Îµİ¼õ5Ãë
 409   3                    set_timenb=set_timenb-5;
 410   3                      if(set_timenb<=15)
 411   3                        set_timenb=15;
 412   3            sec_nb=set_timenb;      //ÖØ¸³ÄÏ±±·½ÏòµÄÆğÊ¼Öµ
 413   3            sec_dx=set_timenb+5;    //ÖØ¸³¶«Î÷·½ÏòµÄÆğÊ¼Öµ
 414   3            num_che_nb=0;//ÇåÁã
 415   3          }   
 416   2          
 417   2          
 418   2          
 419   2          
 420   2          if(dx_nb==1&&sec_dx==0)     //µ±»ÆµÆÉÁË¸Ê±¼äµ½
 421   2          {
 422   3            P2=0X00;          //ÖØÖÃ¶«Î÷ÄÏ±±µÄºìÂÌµÆ×´Ì¬
 423   3            Green_dx=1;          //¶«Î÷ÂÌµÆÁÁ
 424   3            Red_nb=1;          //ÄÏ±±ºìµÆÁÁ
 425   3            dx_nb=!dx_nb;        //È¡·´
C51 COMPILER V9.57.0.0   JTD                                                               03/09/2019 16:45:41 PAGE 8   

 426   3            shanruo=0;          //ÉÁË¸
 427   3            if(num_che_dx>set_timedx/2)//Èç¹û´ËÊ±ÄÏ±±Í¨ĞĞµÄ³µÁ¾Êı´óÓÚÔ¤ÉèÍ¨ĞĞÁ¿
 428   3                    set_timedx=set_timedx+5;  
 429   3            if(num_che_dx==0)//Èç¹û¶«Î÷·½ÏòÎŞ³µÁ¾Í¨ĞĞ,Ã¿´Îµİ¼õ5Ãë
 430   3                    set_timedx=set_timedx-5;
 431   3                    if(set_timedx<=15)
 432   3                          set_timedx=15;
 433   3            sec_dx=set_timedx;      //ÖØ¸³¶«Î÷·½ÏòµÄÆğÊ¼Öµ
 434   3            sec_nb=set_timedx+5;    //ÖØ¸³ÄÏ±±·½ÏòµÄÆğÊ¼Öµ
 435   3            num_che_dx=0;//ÇåÁã
 436   3          }
 437   2        } 
 438   1      }
 439          void time1(void) interrupt 3  //¶¨Ê±ÖĞ¶Ï×Ó³ÌĞò
 440          {
 441   1        TH1=0X3C;             //ÖØ¸³³õÖµ
 442   1        TL1=0XB0;             //12m¾§Õñ50ms//ÖØ¸³³õÖµ
 443   1        countt1++;              //Èí¼ş¼ÆÊı¼Ó1
 444   1        if(countt1==10)            // ¶¨Ê±Æ÷ÖĞ¶Ï´ÎÊı=10Ê±£¨¼´0.5Ãë£©
 445   1        {
 446   2            Yellow_nb=0;        //ÄÏ±±»ÆµÆÃğ
 447   2            Yellow_dx=0;        //¶«Î÷»ÆµÆÃğ
 448   2        }
 449   1        if(countt1==20)                     // ¶¨Ê±Æ÷ÖĞ¶Ï´ÎÊı=20Ê±£¨¼´1ÃëÊ±£©
 450   1        { countt1=0;            //ÇåÁã¼ÆÊıÆ÷
 451   2            Yellow_nb=1;          //ÄÏ±±»ÆµÆÁÁ
 452   2            Yellow_dx=1;          //¶«Î÷»ÆµÆÁÁ
 453   2        } 
 454   1      }
 455          
 456          
 457          //Íâ²¿ÖĞ¶Ï0
 458          void int0(void) interrupt 0 using 1    //Ö»ÔÊĞí¶«Î÷Í¨ĞĞ
 459          {
 460   1      
 461   1      }
 462          
 463          //Íâ²¿ÖĞ¶Ï1
 464          void int1(void) interrupt 2 using 1      //Ö»ÔÊĞíÄÏ±±Í¨ĞĞ 
 465          {
 466   1      
 467   1      }
 468          
 469          void Com_Int(void) interrupt 4      //´®¿ÚÖĞ¶Ï×Óº¯Êı
 470          {
 471   1          uchar i;
 472   1          uchar receive_data , ruturn_data[36];
 473   1        
 474   1          EA = 0;
 475   1        
 476   1          if(RI == 1) //µ±Ó²¼ş½ÓÊÕµ½Ò»¸öÊı¾İÊ±£¬RI»áÖÃÎ»
 477   1        {     
 478   2          RI = 0;
 479   2          receive_data = SBUF;//½ÓÊÕµ½µÄÊı¾İ
 480   2            
 481   2          if(receive_data == '1')  
 482   2          {
 483   3            key_to1();
 484   3            display();    
 485   3          }
 486   2          else if(receive_data == '2')
 487   2          {
C51 COMPILER V9.57.0.0   JTD                                                               03/09/2019 16:45:41 PAGE 9   

 488   3            key_to2();
 489   3            display();    
 490   3          }
 491   2          else if(receive_data == '3')
 492   2          {
 493   3            key_to3();
 494   3            display();    
 495   3          }
 496   2          else if(receive_data == '4')
 497   2          {
 498   3            key_to4();
 499   3            display();    
 500   3          }
 501   2          else if(receive_data == '5')
 502   2          {
 503   3            key_to5();
 504   3            display();    
 505   3          }
 506   2          else
 507   2          {
 508   3            *ruturn_data = "error command";
*** WARNING C260 IN LINE 508 OF jtd.c: '=': pointer truncation
 509   3          }
 510   2        }
 511   1          for(i=0; i<36; i++)
 512   1          {
 513   2            SBUF = ruturn_data[i];   //½«Òª·¢ËÍµÄÊı¾İ·ÅÈëµ½·¢ËÍ¼Ä´æÆ÷
 514   2            while(!TI);       //µÈ´ı·¢ËÍÊı¾İÍê³É
 515   2            TI=0;             //Çå³ı·¢ËÍÍê³É±êÖ¾Î»
 516   2          }
 517   1          EA = 1;
 518   1      }
 519          void logo()//¿ª»úµÄLogo  "- - - -"
 520          { 
 521   1        for(n=0;n<50;n++) //Ñ­»·ÏÔÊ¾----50´Î
 522   1          {
 523   2            P0=0x40;  //ËÍĞÎ¡°-¡±
 524   2            P1=0xfe;  //µÚÒ»Î»ÏÔÊ¾
 525   2          delay(1); //ÑÓÊ±
 526   2            P1=0xfd;  //µÚ¶şÎ»ÏÔÊ¾
 527   2          delay(1); //ÑÓÊ±
 528   2          P1=0Xfb;  //µÚÈıÎ»ÏÔÊ¾
 529   2          delay(1); //ÑÓÊ±
 530   2          P1=0Xf7;  //µÚËÄÎ»ÏÔÊ¾
 531   2          delay(1); //ÑÓÊ±
 532   2            P1 = 0xff;  //ÃğÏÔÊ¾
 533   2        }
 534   1      }
 535          
 536          void delay(int ms)    //ÑÓÊ±×Ó³ÌĞò
 537          {
 538   1        uint j,k;
 539   1        for(j=0;j<ms;j++)     //ÑÓÊ±ms
 540   1           for(k=0;k<124;k++);    //´óÔ¼1ºÁÃëµÄÑÓÊ±
 541   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1072    ----
   CONSTANT SIZE    =     25    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
C51 COMPILER V9.57.0.0   JTD                                                               03/09/2019 16:45:41 PAGE 10  

   DATA SIZE        =     15      37
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      4    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
